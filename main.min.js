!function(){"use strict";function t(){}t.prototype={preload:function(){this.load.image("preloader","assets/preloader.gif")},create:function(){this.game.input.maxPointers=1,this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.device.desktop?(this.game.scale.pageAlignHorizontally=!0,this.game.scale.setGameSize(320,480)):(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.world.height<480&&this.game.scale.setGameSize(320,480),this.game.scale.minWidth=320,this.game.scale.minHeight=372,this.game.scale.maxWidth=800,this.game.scale.maxHeight=1024,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0,this.game.scale.setScreenSize(!0),console.log("aspectRatio",this.scale.aspectRatio)),this.game.state.start("preloader")}},window["hello-phaser"]=window["hello-phaser"]||{},window["hello-phaser"].Boot=t}(),function(){"use strict";function t(){this.ns=window["hello-phaser"]||{},this.sound=null}t.prototype={create:function(){this.center={x:this.game.width/2,y:this.game.height/2};var t=this.ns.win?"WIN":"LOSE";this.titleTxt=this.game.add.bitmapText(this.center.x,this.center.y,"minecraftia",t,22),this.titleTxt.align="center",this.titleTxt.x=this.center.x-this.titleTxt.width/2,this.input.onUp.add(this.onUp,this),this.sound=this.add.audio("happy"),this.sound.play()},onUp:function(){this.game.state.start("menu")}},window["hello-phaser"]=window["hello-phaser"]||{},window["hello-phaser"].End=t}(),function(){"use strict";function t(){this.ns=window["hello-phaser"]||{},this.timerLabel=null,this.scoreLabel=null,this.effectsSounds=null,this.centerPoint={x:0,y:0}}t.prototype={TOTAL_FRUIT:4,SCROLL_Y_PER_SECOND:4,TOTAL_TIME:30,SCORE_PER:10,create:function(){this.ns.score=0,this.scrollHeight=this.world.height,this.initSpriteNum=this.rnd.integerInRange(30,50),this.ns.score=0,this.beginSecond=this.time.totalElapsedSeconds(),this.sprites=this.add.group(),this.bombs=this.add.group(),this.effects=this.add.group();for(var t=0;t<this.initSpriteNum;++t)this.randomSprite();this.timerLabel=this.add.bitmapText(this.game.width-65,0,"minecraftia",this.TOTAL_TIME+"s",22),this.scoreLabel=this.add.bitmapText(15,0,"minecraftia","score: "+this.ns.score,22),this.effectsSounds=this.add.audio("effect_sounds"),this.effectsSounds.addMarker("ping",10,1)},enableDebug:function(){},generateScale:function(){return this.rnd.integerInRange(8,15)/10},randomAngle:function(t){t.angle=this.rnd.angle()},randomSprite:function(){var t=null;this.rnd.between(0,100)>95?(t=this.bombs.create(this.rnd.integerInRange(20,this.game.width-20),this.rnd.integerInRange(20,this.scrollHeight-20),"assemble","bomb.png"),t.tag="bomb"):(t=this.sprites.create(this.rnd.integerInRange(20,this.game.width-20),this.rnd.integerInRange(20,this.scrollHeight-20),"assemble","fruit_0"+this.rnd.integerInRange(0,this.TOTAL_FRUIT-1)+".png"),t.tag="fruit"),t.anchor.set(.5),t.inputEnabled=!0,t.events.onInputUp.add(this.spriteInputUp,this),t.events.onKilled.add(this.spriteKilled,this),console.dir(t.anchor);var e=this.generateScale();return t.scale.set(e),this.randomAngle(t),t},spriteInputUp:function(t){t.kill()},spriteKilled:function(t){var e="bomb"==t.tag?-1:1;this.effectsSounds.play("ping"),this.ns.score+=this.SCORE_PER*e;var i=this.game.add.bitmapText(this.scoreLabel.x+this.scoreLabel.width-10,this.scoreLabel.y,"minecraftia",(-1===e?"-":"+")+this.SCORE_PER,22,this.effects);this.game.add.tween(i).to({fontSize:48,alpha:0,alive:!1},1e3).start().onComplete.addOnce(this.onEffectLabelOnComplete,this);for(var s=null;s=this.sprites.getFirstDead();)this.sprites.removeChild(s)},onEffectLabelOnComplete:function(t){this.effects.removeChild(t)},update:function(){},render:function(){this.scoreLabel.text="score: "+this.ns.score;var t=this.time.totalElapsedSeconds()-this.beginSecond,e=this.TOTAL_TIME-t;console.log(this.sprites.length),(0>=e||!this.sprites.length)&&this.game.state.start("menu"),this.timerLabel.text=parseInt(e)+"s"}},window["hello-phaser"]=window["hello-phaser"]||{},window["hello-phaser"].Game=t}(),function(){"use strict";function t(){this.ns=window["hello-phaser"]||{},this.timerLabel=null,this.scoreLabel=null,this.effectsSounds=null,this.level=0,this.centerPoint={x:0,y:0}}t.prototype={TOTAL_TIME:30,SCORE_PER:10,create:function(){this.ns.score=0,this.scrollHeight=this.world.height,this.ns.score=0,this.beginSecond=this.time.totalElapsedSeconds(),this.sprites=this.add.physicsGroup(Phaser.Physics.ARCADE),this.bombs=this.add.group(),this.effects=this.add.group(),this.level1(),this.timerLabel=this.add.bitmapText(this.game.width-65,0,"minecraftia",this.TOTAL_TIME+"s",22),this.scoreLabel=this.add.bitmapText(15,0,"minecraftia","score: "+this.ns.score,22),this.effectsSounds=this.add.audio("effect_sounds"),this.effectsSounds.addMarker("ping",10,1)},showLevel:function(t){var e=this.game.add.bitmapText(this.world.centerX,this.world.centerY,"minecraftia","Level "+t,32,this.effects);e.x-=e.width/2,e.y-=e.height/2,this.game.add.tween(e).to({fontSize:50,alpha:0,alive:!1,x:e.x-10,y:e.y-10},1e3,Phaser.Easing.Linear.None,!0,1e3).onComplete.addOnce(this.onEffectLabelOnComplete,this)},level1:function(){this.level=1,this.showLevel(this.level),this.initSpriteNum=this.rnd.integerInRange(30,50);for(var t=0;t<this.initSpriteNum;++t)this.randSprite();this.beginSecond=this.time.totalElapsedSeconds()},level2:function(){this.level=2,this.showLevel(this.level),this.initSpriteNum=this.rnd.integerInRange(30,50);for(var t=0;t<this.initSpriteNum;++t)this.randSprite();this.beginSecond=this.time.totalElapsedSeconds()},randSprite:function(){var t=null;t=2===this.level&&this.rnd.between(0,100)>60?this.sprites.create(this.rnd.between(100,this.world.width-100),this.rnd.between(100,this.world.height-100),"nyan_cat_cool"):this.sprites.create(this.rnd.between(100,this.world.width-100),this.rnd.between(100,this.world.height-100),"nyan_cat"),t.animations.add("walk"),t.animations.play("walk",10,!0),t.body.velocity.set(this.rnd.between(-60,60),this.rnd.between(-60,60)),t.body.collideWorldBounds=!0,t.body.bounce.x=1,t.body.bounce.y=1,t.inputEnabled=!0,t.scale.set(.2),t.events.onInputUp.add(this.spriteInputUp,this),t.events.onKilled.add(this.spriteKilled,this)},spriteInputUp:function(t){console.log("kill"),t.kill()},spriteKilled:function(t){var e="nyan_cat_cool"===t.key?-1:1;this.effectsSounds.play("ping"),this.ns.score+=this.SCORE_PER*e;var i=this.game.add.bitmapText(this.scoreLabel.x+this.scoreLabel.width-10,this.scoreLabel.y,"minecraftia",(-1===e?"-":"+")+this.SCORE_PER,22,this.effects);this.game.add.tween(i).to({fontSize:48,alpha:0,alive:!1},1e3).start().onComplete.addOnce(this.onEffectLabelOnComplete,this);for(var s=null;s=this.sprites.getFirstDead();)this.sprites.removeChild(s)},onEffectLabelOnComplete:function(t){this.effects.removeChild(t)},update:function(){this.physics.arcade.collide(this.sprites),this.rnd.between(0,100)>99&&this.randSprite()},render:function(){this.scoreLabel.text="score: "+this.ns.score,1===this.level&&this.ns.score>=300&&this.level2();var t=this.time.totalElapsedSeconds()-this.beginSecond,e=this.TOTAL_TIME-t;(0>=e||!this.sprites.length)&&this.game.state.start("menu"),this.timerLabel.text=parseInt(e)+"s"}},window["hello-phaser"]=window["hello-phaser"]||{},window["hello-phaser"].Game2=t}(),window.onload=function(){"use strict";var t,e=window["hello-phaser"];e.url={leaderboard:"assets/demo/data/leaderboard.json"},t=new Phaser.Game("100","100",Phaser.AUTO,"hello-phaser-game"),t.state.add("boot",e.Boot),t.state.add("preloader",e.Preloader),t.state.add("menu",e.Menu),t.state.add("game",e.Game),t.state.add("game2",e.Game2),t.state.add("end",e.End),t.state.start("boot")},function(){"use strict";function t(){this.ns=window["hello-phaser"]||{},this.titleTxt=null,this.startTxt=null}t.prototype={preload:function(){this.load.json("leaderboard.json",this.ns.url.leaderboard,!0);var t=this.cache.getJSON("leaderboard.json");if(0===t.code){if(this.leaderboards=t.data,!this.leaderboards)return;for(var e=0;e<this.leaderboards.length;e++){var i=this.leaderboards[e];this.load.image(i.avatar,i.avatar)}}else alert(t.msg)},create:function(){this.stage.setBackgroundColor("#c1ebf9"),this.ns.bgm||(this.ns.bgm=this.add.audio("bgm",.6,!0),this.ns.bgm.play("",0,.6,!0)),this.title=this.add.image(this.world.centerX,60,"assemble","txt_title.png"),this.title.anchor.set(.5),this.btnStart=this.add.button(this.world.centerX,this.world.centerY-40,"assemble",this.onStart,this,"btn_start_00.png","btn_start_00.png","btn_start_01.png","btn_start_00.png"),this.btnStart.anchor.set(.5),this.btnStart2=this.add.button(this.world.centerX,this.world.centerY+20,"assemble",this.onStart2,this,"btn_start_2_00.png","btn_start_2_00.png","btn_start_2_01.png","btn_start_2_00.png"),this.btnStart2.anchor.set(.5),this.btnLeaderboard=this.add.button(this.btnStart2.position.x,this.btnStart2.position.y+this.btnStart.height+10,"assemble",this.onLeaderboardOpen,this,"btn_leaderboard_00.png","btn_leaderboard_00.png","btn_leaderboard_01.png","btn_leaderboard_00.png"),this.btnLeaderboard.anchor.set(.5),this.initLeaderboard(),this.initCoupon()},enableGameBtn:function(t){var e=t?2:-1;this.btnLeaderboard.input.priorityID=e,this.btnStart.input.priorityID=e,this.btnStart2.input.priorityID=e},initCoupon:function(){if(void 0!==this.ns.score){this.sound=this.add.audio("happy"),this.sound.play();var t=this.game.add.bitmapText(this.world.centerX,90,"minecraftia","score: "+this.ns.score,22,this.effects);if(t.x-=t.width/2,this.ns.score>=300){var e=this.add.sprite(this.world.centerX,0,"assemble","coupon.jpg");e.anchor.set(.5),e.inputEnabled=!0,e.input.priorityID=3,e.events.onInputUp.add(function(t){this.add.tween(e).to({y:-t.height/2},2e3,Phaser.Easing.Bounce.In,!0)},this),this.add.tween(e).to({y:this.world.height/2},2e3,Phaser.Easing.Bounce.Out,!0)}}},initLeaderboard:function(){this.dialogLeaderboard=this.add.sprite(this.world.centerX,this.world.centerY,"assemble","dialog_leaderboard.png"),this.dialogLeaderboard.anchor.set(.5),this.dialogLeaderboard.alpha=.9,this.bmd=this.make.bitmapData(this.dialogLeaderboard.width-22,this.dialogLeaderboard.height),this.dialogLeaderboardContent=this.make.sprite(-this.dialogLeaderboard.width/2+10,-this.dialogLeaderboard.height/2+10,this.bmd);var t=this.add.graphics(0,0);t.beginFill(),t.drawRect(this.dialogLeaderboard.x-this.dialogLeaderboardContent.width/2,this.dialogLeaderboard.y-this.dialogLeaderboard.height/2+10,this.dialogLeaderboardContent.width,this.dialogLeaderboard.height-20),t.endFill(),this.dialogLeaderboardContent.mask=t,this.game.physics.arcade.enable(this.dialogLeaderboardContent),this.dialogLeaderboardContent.body.velocity.y=0,this.dialogLeaderboardContent.body.drag.set(100),this.dialogLeaderboardContent.body.maxVelocity.set(200),this.dialogLeaderboardContent.inputEnabled=!0,this.dialogLeaderboardContent.input.allowHorizontalDrag=!1,this.dialogLeaderboardContent.input.enableDrag(!1,!1,!1,255,new Phaser.Rectangle(this.dialogLeaderboardContent.x,this.dialogLeaderboardContent.y-this.dialogLeaderboardContent.height+this.dialogLeaderboard.height-20,this.dialogLeaderboardContent.width,2*this.dialogLeaderboardContent.height-this.dialogLeaderboard.height+20)),this.dialogLeaderboardContent.input.enableDrag(),this.dialogLeaderboardContent.events.onDragStart.add(this.onLeaderboardDragStart,this),this.dialogLeaderboardContent.events.onDragStop.add(this.onLeaderboardDragStop,this),this.dialogLeaderboard.addChild(this.dialogLeaderboardContent),this.btnClose=this.make.button(this.dialogLeaderboard.width/2-5,-(this.dialogLeaderboard.height/2-5),"assemble",this.onLeaderboardClose,this,"btn_close_00.png","btn_close_00.png","btn_close_01.png","btn_close_00.png"),this.btnClose.anchor.set(.5),this.btnClose.input.priorityID=1,this.btnClose.useHandCursor=!0,this.dialogLeaderboard.addChild(this.btnClose),this.setupLeaderboardContent(),this.dialogLeaderboard.scale.set(0),this.enableGameBtn(!0)},setupLeaderboardContent:function(){var t=100,e=this.dialogLeaderboard.height;if(this.leaderboards){var i=t*this.leaderboards.length;i>e&&(e=i)}var s=this.make.bitmapData(this.dialogLeaderboardContent.width,e);if(s.rect(0,0,s.width,s.height,"#ffffff"),this.leaderboards)for(var a=20,n=0;n<this.leaderboards.length;n++,a+=t){var o=this.leaderboards[n],r=this.make.sprite(0,0,o.avatar);r.scale.set(60/r.height),s.draw(r,0,a);var d=this.make.text(0,0,n+1+"."+o.nick_name,{font:"18px Arial",align:"left"});s.draw(d,r.width+10,a+10);var h=this.make.text(0,0,o.score,{font:"16px Arial",align:"left"});s.draw(h,r.width+10,a+40)}this.dialogLeaderboardContent.loadTexture(s),this.dialogLeaderboardContent.input.enableDrag(!1,!1,!1,255,new Phaser.Rectangle(this.dialogLeaderboardContent.x,this.dialogLeaderboardContent.y-this.dialogLeaderboardContent.height+this.dialogLeaderboard.height-20,this.dialogLeaderboardContent.width,2*this.dialogLeaderboardContent.height-this.dialogLeaderboard.height+20))},onLeaderboardDragStart:function(t){t.draging=!0,t.body.velocity.setTo(0)},onLeaderboardDragMove:function(t){this.lastDragPoint&&this.lastDragPoint.time+500>this.time.now||(this.lastDragPoint={x:t.x,y:t.y,time:this.time.now})},onLeaderboardDragStop:function(t){t.draging=!1,this.lastDragStopPoint={x:this.input.position.x,y:this.input.position.y,time:this.time.now},console.dir(this.input.pointer1)},onLeaderboardClose:function(){this.dialogLeaderboard.tween&&this.dialogLeaderboard.tween.isRunning||0===this.dialogLeaderboard.scale.x||(this.dialogLeaderboard.tween=this.add.tween(this.dialogLeaderboard.scale).to({x:0,y:0},500,Phaser.Easing.Elastic.In,!0),this.enableGameBtn(!0))},onLeaderboardOpen:function(){this.dialogLeaderboard.tween&&this.dialogLeaderboard.tween.isRunning||1===this.dialogLeaderboard.scale.x||(this.dialogLeaderboard.tween=this.add.tween(this.dialogLeaderboard.scale).to({x:1,y:1},1e3,Phaser.Easing.Elastic.Out,!0),this.enableGameBtn())},onStart:function(){this.game.state.start("game")},onStart2:function(){this.game.state.start("game2")},update:function(){this.dialogLeaderboardContent&&this.dialogLeaderboardContent.draging&&this.onLeaderboardDragMove(this.input.position)}},window["hello-phaser"]=window["hello-phaser"]||{},window["hello-phaser"].Menu=t}(),function(){"use strict";function t(){this.ns=window["hello-phaser"]||{},this.asset=null,this.ready=!1}t.prototype={preload:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.setPreloadSprite(this.asset),this.loadResources()},loadResources:function(){this.load.json("leaderboard.json",this.ns.url.leaderboard,!0),this.load.spritesheet("nyan_cat","assets/nyan_cat_3x4.png",273,169,12),this.load.spritesheet("nyan_cat_cool","assets/nyan_cat_cool_3x4.png",257,159,12),this.load.atlas("assemble","assets/assemble.png","assets/assemble.json"),this.load.bitmapFont("minecraftia","assets/minecraftia.png","assets/minecraftia.xml"),this.load.audio("bgm",["assets/bgm.mp3","assets/bgm.ogg"]),this.load.audio("effect_sounds",["assets/fx_mixdown.mp3","assets/fx_mixdown.ogg"]),this.load.audio("happy",["assets/happy.mp3","assets/happy.ogg"])},create:function(){this.asset.cropEnabled=!1},update:function(){this.ready&&this.game.state.start("menu")},onLoadComplete:function(){this.ready=!0}},window["hello-phaser"]=window["hello-phaser"]||{},window["hello-phaser"].Preloader=t}();